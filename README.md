# autoXRAY - личный ВПН сервер
Bash-скрипт для автоматической настройки ядра [Xray](https://github.com/XTLS/Xray-core). Предназначен для удобного получения актуальных конфигураций VPN для семейного/личного использования, настраивает selfsteal VLESS [XHTTP](https://github.com/XTLS/Xray-core/discussions/4113#discussioncomment-11468947) / [RAW](https://github.com/XTLS/REALITY/blob/main/README.en.md) REALITY.

**UPD3: Обход новых блокировок - скрипт переработан на vless xhttp reality**

**UPD2: Описание неактуальных скриптов перемещено в [oldScriptReadme.md](https://github.com/xVRVx/autoXRAY/blob/main/old/oldScriptReadme.md).**

**UPD1: Добавлен новый раздел — [построение моста RU -> EU](#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC-%D0%BC%D0%BE%D1%81%D1%82-ru---eu).**

Рекомендуемая система: чистая Ubuntu 24/Debian 12 с root правами.


===========================================================================

## Конфигурация с клиентским конфигом для РФ (рекомендуется)
Будем использовать маскировку под собственный сайт (selfsteal), который крутится на вашем же VPS. 

Для установки надо [арендовать VPS](#выбор-сервера-подбирал-промо-тарифы) и [получить домен](#получаем-домен).

Автоматически перенаправляет весь ру трафик напрямую.
```bash

bash -c "$(curl -L https://raw.githubusercontent.com/xVRVx/autoXRAY/main/autoXRAYselfConfRUxhttp.sh)" -- вашДОМЕН.com
```

**Вы получите:**
1) vless RAW reality XTLS на 443 порту - хорошая маскировка, быстрый.
2) vless XHTTP reality на 443 порту - современный протокол на стандартных настройках, требует повышенной вычислительной мощности процессора.
3) vless XHTTP reality EXTRA на 443 порту - продвинутые настройки соединения.
4) shadowsocks 2022-blake3-chacha20-poly1305 на 8443 порту  - новый, простой и быстрый.
5) socks5 прокси на 10443 порту - используйте для сервисов (например: ТГ).


===========================================================================

## Выбор сервера (подбирал промо тарифы)

- [senko.digital](https://senko.digital/?ref=47670) - от 2€, есть днс-хостинг и домены для selfsteel, есть оплата СБП.
- [notbad](https://my.notbad.cloud/?from=188) - от 3$, есть оплата рублями, хороший курс и канал.
- [WAICORE](https://waicore.com/?from=3063) - от 2€ промо, есть оплата рублями.
- [XorekCloud](https://xorek.cloud/?from=28522) - тут есть новый промо тариф, за 150 руб./мес.
- [hosting-russia](https://hosting-russia.ru/?p=57731) - ру сервера от 180 рублей, для моста ru-eu.
- [cloudcore](https://cloudcore.ru/?affiliate_uuid=e9ad7432-7898-4de2-8606-38eb90e0c1a6) - ру сервера от 100 рублей, для моста ru-eu.



## Получаем домен

**Получаем бесплатный поддомен**: регестрируемся в [cloudns](https://www.cloudns.net/aff/id/1919804/). Далее: Управление -> DNS Хостинг -> Создать зону -> Свободная зона -> вводим рандомное имя для поддомена.
Теперь надо создать A-запись: Новая запись -> Тип А -> Хост (имя субдомена) -> Указывает на (IP адрес вашего VPS).

Еще бесплатный поддомен можно получить тут -> https://freedns.afraid.org/ (он немного лагучий, но на первом иногда возникают лимиты на Let's Encrypt).

**Платный домен и бесплатный днс-хостинг можно получить** в [senko.digital](https://senko.digital/?ref=47670). Здесь же можно арендовать промо VPS.
Платные сервисы, как правило, работают стабильнее.

Помните, что DNS-записи обновляются не сразу: иногда это занимает 15 минут, иногда — час и более. Проверить - [xseo.in/dns](https://xseo.in/dns).



## Настройка VPN
**Скопируйте конфиг (страничка подписки) в специализированное приложение:**

- iOS/macOS: [Happ](https://www.happ.su/main/ru) или [v2rayTun](https://v2raytun.com/) | (FoXray, Hiddify)
- Android: [Happ](https://www.happ.su/main/ru) или [v2rayTun](https://v2raytun.com/) | (v2rayNG, SimpleXray)
- Windows: [winLoadXray](https://github.com/xVRVx/winLoadXRAY/releases/latest/download/winLoadXRAY.exe), [v2rayN](https://github.com/2dust/v2rayN/releases/) | (Happ, v2rayTun, Throne, Hiddify)
- Linux:  [v2rayN](https://github.com/2dust/v2rayN/releases/) | (Happ, Throne, Hiddify)

() - не поддерживают клиентский конфиг, только vless:// (конфиг для роутера).


===========================================================================

## Пояснение и рекомендации

Сейчас в сети много инструкций по установке GUI-панелей, таких как PasarGuard, 3x-ui или новая RemnaWave. Однако все они избыточны для домашнего использования, так как предназначены для крупных проектов и отличаются высокой сложностью настройки (также используют ядро xray). 

Мануал, который необходимо пройти до получения первого рабочего конфига, занимает более 10 страниц. 
Кроме того, подходящий конфиг для Xray нужно ещё поискать и правильно настроить — с этим отлично справляется данный скрипт.

Без GUI и базы данных Xray потребляет меньше ресурсов сервера и отлично подходит для запуска на слабых VPS-конфигурациях!

При каждом запуске autoXRAY генерирует новые UUID, ключи и пароли для защиты пользователей.

**Преимущества selfsteal**
- Сайт всегда работает на вашем ВПС - устраняется точка отказа.
- Ниже пинг - быстрее соединение.
- Не используются CDN, которые есть на многих популярных сайтах.
- Лучше маскировка - т.к. сайт находится в той же сети что и сервер.

**Обновить ядро xray**
```bash
bash -c "$(curl -L https://github.com/XTLS/Xray-install/raw/main/install-release.sh)" @ install
```

**Перейти на алгоритм BBR**

Если у вас много одновременных подключений, то можно включить алгоритм BBR (от гугла) - поможет повысить пропускную способность VPN.
Проверка текущего алгоритма: sysctl net.ipv4.tcp_congestion_control


## Смена паролей и сайта маскировки

Запустите скрипт заново - он сформирует новые конфигурации VPN для YouTube, chatGPT и других нужных сайтов.

## Повышенная маскировка

Настоятельно рекомендуется: сменить порт ssh со стандартного 22 на другой и/или сделать вход на сервер по ключу. Настроить файрвол и оставить открытыми порты для работы скрипта: ваш ssh порт, 80 для certbot, 443 и 8443 для xray.

Если вы хотите погрузиться в дело конфигурации xray есть отличный [справочник](https://xtls.github.io/ru/config/outbounds/vless.html) и [руководство](https://github.com/XTLS/Xray-core/discussions/3518).

Редактировать конфиг можно тут: **/usr/local/etc/xray/config.json**

После изменений ядро надо перезапустить: **systemctl restart xray**


===========================================================================

## Настраиваем мост RU -> EU
Многие столкнулись с блокировками хостинг-сетей по TLS (особенно при использовании мобильного интернета). Существует решение — построение моста между серверами в разных локациях. Для этого необходимо:

1) На заблокированный чистый VPS ставим стандартный рекомендованный скрипт и берем стандартый получившийся XHTTP конфиг №2:
```bash
bash -c "$(curl -L https://raw.githubusercontent.com/xVRVx/autoXRAY/main/autoXRAYselfConfRUxhttp.sh)" -- поддомен1.вашДОМЕН.com

```
2) На ru VPS ставим новый скрипт (здесь нам понадобится vless XHTTP reality конфиг №2):
```bash
bash -c "$(curl -L https://raw.githubusercontent.com/xVRVx/autoXRAY/main/autoXRAYselflConfRUbrEUxhttp.sh)" -- поддомен2.вашДОМЕН.com "vless://вашКонфигXHTTP"
```
Установится прокси мост между серверами, итоговая цепочка: конфиг клиента -> ru VPS -> eu VPS -> зарубежный сайт

Также можно взять vless RAW reality XTLS и использовать предыдущий скрипт моста:
```bash
bash -c "$(curl -L https://raw.githubusercontent.com/xVRVx/autoXRAY/main/old/autoXRAYselfstealConfRUbrEU.sh)" -- поддомен2.вашДОМЕН.com "vless://вашКонфигRAW"
```


===

**Если вы хотите пускать YouTube через ruVPS (у вас он без ТСПУ или вы поставили и настроили [zapret4rocket](https://github.com/IndeecFOX/zapret4rocket))**

Тогда в конфиге ruVPS, который лежит /usr/local/etc/xray/config.json надо добавить в строке 146:
```bash
"geosite:youtube",
"youtube.com",
"googlevideo.com",
"ytimg.com",
"ggpht.com",
```
и перезапустить ядро: **systemctl restart xray**

===========================================================================

Скрипты будут дорабатываться до актуального состояния.

**[Поддержать автора.](https://pay.cryptocloud.plus/pos/Weu1Y0fOhLho0nte)**
